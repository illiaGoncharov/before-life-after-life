"use strict";(self.webpackChunkbefore_life_after_life=self.webpackChunkbefore_life_after_life||[]).push([[42],{42:(e,r,t)=>{t.r(r),t.d(r,{default:()=>a});var n=t(43),o=t(354),i=t(579);const c={"before life":1,home:2,"family at home":3,birth:4,"unintended child":5,puberty:6,"bullied teen":7,love:8,"love between men":9,"love between women":10,sex:11,"unsafe sex":12,"healthy person":13,"sick person":14,"person with mental health condition":15,"person with substance use disorder":16,immigrant:17,"apolitical person":18,propaganda:19,"people at protest":20,"rich politician":21,"poor politician":22,"poor person":23,"homeless person":24,"unemployed person":25,influencer:26,artist:27,"office worker":28,city:29,"city celebration":30,"city at war":31,"person at war":32,"woman at war":33,"women military parade":34,"tampon in blood":35,"bullet in blood":36,"elderly person":37,"dying person":38,euthanasia:39,"dying pet":40,death:41,funeral:42,cemetery:43,religion:44,afterlife:45};const a=function(){const[e,r]=(0,n.useState)(window.innerHeight),[t,a]=(0,n.useState)(null),[s,l]=(0,n.useState)(!1),[u,d]=(0,n.useState)(!1),[f,m]=(0,n.useState)(!0),[p,h]=(0,n.useState)(!1),y=(0,n.useRef)(null),g=(0,n.useRef)(null),b=(0,n.useRef)(null),v=(0,n.useRef)(null),w=(0,n.useRef)(0);(0,n.useEffect)((()=>{const e=setTimeout((()=>{m(!1),d(!0)}),2e3);return()=>clearTimeout(e)}),[]),(0,n.useEffect)((()=>{const e={video:{facingMode:"user",width:{ideal:1280},height:{ideal:720}}},r=async()=>{try{const r=await navigator.mediaDevices.getUserMedia(e);g.current&&(g.current.srcObject=r,g.current.onloadedmetadata=()=>{g.current.play().catch((e=>console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f:",e)))},g.current.onpause=()=>{console.log("\u0412\u0438\u0434\u0435\u043e \u043d\u0430 \u043f\u0430\u0443\u0437\u0435, \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c..."),g.current.play().catch((e=>console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430:",e)))})}catch(r){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043a\u0430\u043c\u0435\u0440\u044b:",r)}};r();const t=()=>{"visible"===document.visibilityState&&(console.log("\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0441\u0442\u0430\u043b\u0430 \u0432\u0438\u0434\u0438\u043c\u043e\u0439, \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u043a\u0430\u043c\u0435\u0440\u0443..."),r())};return document.addEventListener("visibilitychange",t),()=>{if(document.removeEventListener("visibilitychange",t),g.current&&g.current.srcObject){g.current.srcObject.getTracks().forEach((e=>{console.log("\u041e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u0442\u0440\u0435\u043a \u043a\u0430\u043c\u0435\u0440\u044b:",e.label),e.stop()}))}}}),[]),(0,n.useEffect)((()=>{try{y.current=new Audio;const e=()=>{l(!1)};y.current.addEventListener("ended",e);const r=e=>{console.error("Audio error:",e),w.current+=1,w.current>=3&&h(!0),l(!1)};return y.current.addEventListener("error",r),()=>{y.current&&(y.current.pause(),y.current.removeEventListener("ended",e),y.current.removeEventListener("error",r))}}catch(e){return console.error("Audio initialization error:",e),h(!0),()=>{}}}),[]),(0,n.useEffect)((()=>{if(!u)return;const e=()=>{try{r((e=>e-.3)),p||(()=>{if(!s&&!p)try{const e=window.innerHeight/2,r=document.querySelectorAll(".text-step");if(!r||!r.length)return;let n=null,o=1/0;if(r.forEach((r=>{try{const t=r.getBoundingClientRect(),i=t.top+t.height/2,c=Math.abs(i-e);c<o&&(o=c,n=r)}catch(t){}})),n&&o<50){const e=n.textContent;if(e&&e!==t&&(a(e),!p)){const r=c[e];r&&x(r)}}}catch(e){console.error("Error in checkCenterPrompt:",e)}})(),b.current=requestAnimationFrame(e)}catch(n){console.error("Animation error:",n),b.current=requestAnimationFrame(e)}};return b.current=requestAnimationFrame(e),()=>{b.current&&cancelAnimationFrame(b.current)}}),[t,s,u,p]);const x=e=>{if(y.current&&!p)try{l(!0);const r=`/before-life-after-life/audio/audio_${String(e).padStart(2,"0")}.mp3`;y.current.paused||y.current.pause(),y.current.src=r;const t=setTimeout((()=>{l(!1)}),1e4);y.current.play().then((()=>{clearTimeout(t)})).catch((e=>{console.error("Audio playback error:",e),clearTimeout(t),l(!1),w.current+=1,w.current>=3&&h(!0)}))}catch(r){console.error("Error playing audio:",r),l(!1)}};return f?(0,i.jsx)("div",{className:"text-container loading",children:(0,i.jsx)("div",{className:"loading-message",children:"Loading..."})}):(0,i.jsxs)("div",{className:"text-container",children:[(0,i.jsx)("video",{ref:g,autoPlay:!0,playsInline:!0,muted:!0,className:"video-bg"}),(0,i.jsx)("div",{ref:v,className:"text-wrapper",style:{transform:`translateY(${-e}px)`},children:o.E.map(((e,r)=>(0,i.jsx)("div",{className:"text-step",children:e},r)))})]})}}}]);
//# sourceMappingURL=42.997caa32.chunk.js.map