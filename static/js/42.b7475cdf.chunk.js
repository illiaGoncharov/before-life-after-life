"use strict";(self.webpackChunkbefore_life_after_life=self.webpackChunkbefore_life_after_life||[]).push([[42],{42:(e,r,t)=>{t.r(r),t.d(r,{default:()=>s});var n=t(43),c=t(354),o=t(321),a=t(579);const i={"before life":1,home:2,"family at home":3,birth:4,"unintended child":5,puberty:6,"bullied teen":7,love:8,"love between men":9,"love between women":10,sex:11,"unsafe sex":12,"healthy person":13,"sick person":14,"person with mental health condition":15,"person with substance use disorder":16,immigrant:17,"apolitical person":18,propaganda:19,"people at protest":20,"rich politician":21,"poor politician":22,"poor person":23,"homeless person":24,"unemployed person":25,influencer:26,artist:27,"office worker":28,city:29,"city celebration":30,"city at war":31,"person at war":32,"woman at war":33,"women military parade":34,"tampon in blood":35,"bullet in blood":36,"elderly person":37,"dying person":38,euthanasia:39,"dying pet":40,death:41,funeral:42,cemetery:43,religion:44,afterlife:45};const s=function(e){let{cameraOn:r=!0,soundOn:t=!0,toggleCamera:s,toggleSound:u}=e;const[l,d]=(0,n.useState)(0),[f,p]=(0,n.useState)(null),[h,m]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!0),[w,E]=(0,n.useState)(!1),x=(0,n.useRef)(null),j=(0,n.useRef)(null),k=(0,n.useRef)(null),A=(0,n.useRef)(null),S=(0,n.useRef)(0),O=(0,n.useRef)(null);(0,n.useEffect)((()=>{const e=setTimeout((()=>{v(!1),b(!0)}),2e3);return()=>clearTimeout(e)}),[]),(0,n.useEffect)((()=>{if(!r){if(j.current&&j.current.srcObject){j.current.srcObject.getTracks().forEach((e=>e.stop())),j.current.srcObject=null,O.current=null}return}const e={video:{facingMode:"user",width:window.innerWidth,height:window.innerHeight}},t=async()=>{try{const t=await navigator.mediaDevices.getUserMedia(e);O.current=t,j.current&&(j.current.srcObject=t,j.current.onloadedmetadata=()=>{j.current&&j.current.play().catch((e=>console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f:",e)))},j.current.onpause=()=>{r&&j.current&&j.current.play().catch((e=>console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430:",e)))})}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043a\u0430\u043c\u0435\u0440\u044b:",t)}};t();const n=()=>{"visible"===document.visibilityState&&r&&t()};return document.addEventListener("visibilitychange",n),()=>{if(document.removeEventListener("visibilitychange",n),O.current){O.current.getTracks().forEach((e=>e.stop())),O.current=null}if(j.current&&j.current.srcObject){j.current.srcObject.getTracks().forEach((e=>e.stop())),j.current.srcObject=null}}}),[r]),(0,n.useEffect)((()=>{try{x.current=new Audio;const e=()=>{m(!1)};x.current.addEventListener("ended",e);const r=e=>{console.error("Audio error:",e),S.current+=1,S.current>=3&&E(!0),m(!1)};return x.current.addEventListener("error",r),()=>{x.current&&(x.current.pause(),x.current.removeEventListener("ended",e),x.current.removeEventListener("error",r))}}catch(e){return console.error("Audio initialization error:",e),E(!0),()=>{}}}),[]),(0,n.useEffect)((()=>{t||!x.current||x.current.paused||(x.current.pause(),m(!1))}),[t]),(0,n.useEffect)((()=>{if(!y)return;const e=()=>{try{d((e=>e-.3)),!w&&t&&(()=>{if(!h&&!w&&t)try{const e=window.innerHeight/2,r=document.querySelectorAll(".text-step");if(!r||!r.length)return;let t=null,n=1/0;if(r.forEach((r=>{try{const c=r.getBoundingClientRect(),o=c.top+c.height/2,a=Math.abs(o-e);a<n&&(n=a,t=r)}catch(c){}})),t&&n<50){const e=t.textContent;if(e&&e!==f&&(p(e),!w)){const r=i[e];r&&T(r)}}}catch(e){console.error("Error in checkCenterPrompt:",e)}})(),k.current=requestAnimationFrame(e)}catch(r){console.error("Animation error:",r),k.current=requestAnimationFrame(e)}};return k.current=requestAnimationFrame(e),()=>{k.current&&cancelAnimationFrame(k.current)}}),[f,h,y,w,t]);const T=e=>{if(x.current&&!w&&t)try{m(!0);const r=`/before-life-after-life/audio/audio_${String(e).padStart(2,"0")}.mp3`;x.current.paused||x.current.pause(),x.current.src=r;const t=setTimeout((()=>{m(!1)}),1e4);x.current.play().then((()=>{clearTimeout(t)})).catch((e=>{console.error("Audio playback error:",e),clearTimeout(t),m(!1),S.current+=1,S.current>=3&&E(!0)}))}catch(r){console.error("Error playing audio:",r),m(!1)}};return g?(0,a.jsx)("div",{className:"text-container loading",children:(0,a.jsx)(o.A,{text:"text",charInterval:50})}):(0,a.jsxs)("div",{className:"text-container",children:[r&&(0,a.jsx)("video",{ref:j,autoPlay:!0,playsInline:!0,muted:!0,className:"video-bg"}),(0,a.jsx)("div",{ref:A,className:"text-wrapper",style:{transform:`translateX(-50%) translateY(${l}px)`},children:[...c.E].reverse().map(((e,r)=>(0,a.jsx)("div",{className:"text-step",children:e},c.E.length-1-r)))})]})}}}]);
//# sourceMappingURL=42.b7475cdf.chunk.js.map